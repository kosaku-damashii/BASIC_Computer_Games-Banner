  1 WIDTH 80 :REM
  2 USEVAR G1,T1,I1,SS,XX
  3 DIM S(7)
 10 PRINT "HORIZONTAL";:X=VAL(INPUT$()) :REM
 20 PRINT "VERTICAL";:Y=VAL(INPUT$()) :REM
 21 PRINT "CENTEED";:L$=INPUT$() :REM
 22 G1=0: IF STRNCMP(L$,"P",1) >0 THEN G1=1 :REM
 23 PRINT "CHARACTER (TYPE 'ALL' IF YOU WANT CHARACTER BEING PRINTED)";:M$=INPUT$() :REM
 29 PRINT "STATENENT";
 30 A$=INPUT$() :REM
 35 PRINT "SET PAGE";:O$=INPUT$() :REM
REM  40 A=ASC(GOSUB$(LEFT, A$,1))
 50 REM
 60 REM
 70 FOR T=1 TO LEN(A$)
 80   P$=GOSUB$(MID,A$,T,I) :REM
 90   FOR Q=1 TO 50
 95     SS$=READ$():S(1)=READ():S(2)=READ():S(3)=READ():S(4)=READ():S(5)=READ():S(6)=READ():S(7)=READ() :REM
 96     IF STRNCMP(P$," ",1)=0 THEN 812
100     IF STRNCMP(P$,SS$,1)=0 THEN 200
120   NEXT :REM
200   RESTORE 899 :REM
201   XX$=M$ :REM
202   IF STRNCMP(M$,"ALL",3)=0 THEN XX$=SS$ :REM
205   FOR U=1 TO 7
210     FOR K=8 TO O STEP -1
230       IF INT(POW#(2,FLOAT#(K))) < S(U) THEN 270 :REM
240       J(9-K)=0
250       GOTO 280
270       J(9-K)=1: S(U)=S(U)-INT(POW#(2,FLOAT#(K))) :REM
272       IF S(U)=1 THEN 815
280     NEXT :REM
445     FOR T1=1 TO X
447       GOSUB TAB,INT((63-4.5*FLOAT#(Y))*FLOAT#(G1)/FLOAT#(LEN(XX$))+1) :REM
450       FOR B=1 TO F(U)
460         IF J(B)=0 THEN 500
465         FOR I=1 TO Y: PRINT XX$;:
466         NEXT :REM
470         GOTO 600
500         FOR I=1 TO Y
510           FOR I1=1 TO LEN(XX$)
520             PRINT " ";
521           NEXT :REM
530         NEXT :REM
600       NEXT :REM
620       PRINT
630     NEXT :REM
700   NEXT :REM
750   FOR H=1 TO 2*X: PRINT : REM
751   NEXT :REM
800 NEXT :REM
806 FOR H=1 TO 75: PRINT : REM
807 NEXT :REM
810 END
812 FOR H=1 TO 7*X: PRINT : REM
813 NEXT :REM
814 GOTO 800 :REM
815 F(U)=9-K: GOTO 445
899 DATA " ",0,0,0,0,0,0,0
900 DATA "A",305,37,33,34,35,37,505
901 DATA "G",125,131,258,258,290,163,101
902 DATA "E",512,274,274,274,274,258,258
903 DATA "T",2,2,2,512,2,2,2
904 DATA "W",256,257,129,65,129,257,256
905 DATA "L",512,257,257,257,257,257,257
906 DATA "S",69,139,274,274,274,163,69
907 DATA "O",125,131,258,258,258,131,125
908 DATA "W",512,7,9,17,33,193,512
909 DATA "F",512,18,18,18,18,2,2
910 DATA "K",512,17,17,41,69,131,258
911 DATA "B",512,274,274,274,274,274,239
912 DATA "D",312,258,258,258,258,131,125
913 DATA "H",512,17,17,17,17,17,512
914 DATA "M",512,7,13,25,13,7,512
915 DATA "!",3,3,2,154,18,11,5
916 DATA "U",128,129,257,257,257,129,128
917 DATA "R",512,18,18,50,82,146,271
918 DATA "P",512,18,18,18,18,18,15
919 DATA "0",125,131,258,258,322,131,381
920 DATA "Y",8,9,17,481,17,9,8
921 DATA "V",64,65,129,257,129,65,64
922 DATA "X",388,69,41,17,41,69,388
923 DATA "Z",386,322,290,274,266,262,260
924 DATA "I",258,259,258,512,258,259,258
925 DATA "C",125,131,258,258,258,131,69
926 DATA "J",65,129,257,257,257,129,128
927 DATA "1",0,0,261,259,512,252,257
928 DATA "2",261,387,322,290,274,267,261
929 DATA "*",49,41,17,512,17,41,69
930 DATA "3",66,130,258,274,266,150,100
931 DATA "4",33,49,41,37,35,512,33
932 DATA "5",160,274,274,274,274,274,226
933 DATA "6",194,291,293,297,305,289,193
934 DATA "7",258,130,66,34,18,10,8
935 DATA "8",69,171,274,274,274,171,69
936 DATA "9",263,138,74,42,26,10,7
937 DATA "+",41,41,41,41,41,41,41
938 DATA "!",1,1,1,384,1,1,1
939 DATA "O",57,69,131,258,131,69,57
940 DATA ".",1,1,129,449,129,1,1
1000 REM STOP :REM
1002 END



REM Subroutines For MachiKania

LABEL LEFT
VAR X,Y,R
X$=ARGS$(1)
Y=ARGS(2)
R$=X$(0,Y)
RETURN R$

LABEL MID
VAR X,Y,Z
X$=ARGS$(1)
Y=ARGS(2)-1
Z=ARGS(3)
R$=X$(Y,Z)
RETURN R$

LABEL TAB
VAR I,J
J=ARGS(1)
FOR I=0 TO J-1
  PRINT " ";
NEXT
RETURN
